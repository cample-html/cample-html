/*!
 * cample-html v0.0.3 (https://github.com/cample-html/cample-html)
 * Copyright (c) 2024 Anton Maklakov
 * Licensed under MIT (https://github.com/cample-html/cample-html/blob/main/LICENSE)
 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.CampleHTML=e.CampleHTML||t()}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";const e=e=>{throw new Error(e)},t="TEMPLATE",o="data-",n=`${o}cample`,r=`${o}src`,s=`${o}method`,l=`${o}status`,d=`${o}after`,i=`${o}mode`,a=()=>document,c=t=>{"string"!=typeof t&&e("Bad response");const o=(new DOMParser).parseFromString(`<template>${t}</template>`,"text/html").childNodes[0].childNodes[0].firstChild,n=o.content,r=n.querySelectorAll("script");for(let e=0;e<r.length;e++){const t=r[e];n.removeChild(t)}return o},u=(t,o,n,r,s,d,i,a,u)=>{const h=new XMLHttpRequest;if(h.open(n.toUpperCase(),r,!0),h.overrideMimeType("text/html"),h.withCredentials=s,i)if("object"!=typeof(p=i)||Array.isArray(p)||null===p)e('The "header" property does not have a value object');else for(const t in i){const[o,n]=t;if("string"==typeof n)try{h.setRequestHeader(o,n)}catch(e){throw e}else e("Header has no string value")}var p;const f=void 0!==u;h.timeout=d;const m=()=>{u.status!==h.status&&(u.status=h.status)},g=e=>{e?t.setAttribute(l,e):t.removeAttribute(l)};f?(h.onabort=m,h.onloadend=m,h.onloadstart=m,h.onprogress=m,h.onreadystatechange=m,h.ontimeout=m):(h.onprogress=()=>g("loading"),h.onabort=()=>g(),h.ontimeout=()=>g()),h.onload=f?()=>{m();try{if(200!==h.status)e(`Request error with code ${h.status}`);else{const{response:e}=h,t=c(e);u.element=t}}catch(e){throw e}}:()=>{g();try{if(200!==h.status)e(`Request error with code ${h.status}`);else{const{response:e}=h,n=c(e).content.childNodes;if(o)if(o.nodes){const e=[],t=o.nodes.length;for(let r=0;r<t;r++){const s=o.nodes[r];if(r===t-1)for(let t=0;t<n.length;t++){const r=n[t],l=o.parentNode.insertBefore(r,s);e.push(l)}o.parentNode.removeChild(s)}o.nodes=e}else{const e=t.parentNode,r=[];for(let o=0;o<n.length;o++){const s=n[o],l=e.insertBefore(s,t);r.push(l)}e.removeChild(t),o.nodes=r,o.parentNode=e}else{const e=t.parentNode;for(let o=0;o<n.length;o++){const r=n[o];e.insertBefore(r,t)}e.removeChild(t)}}}catch(e){throw e}},h.onerror=f?e=>{throw m(),e}:e=>{throw g(),e},void 0!==a?h.send(a):h.send()},h=(t,o,n)=>{const l=t.getAttribute(r);if(l){const r=(t.getAttribute(s)||"GET").toLowerCase();if(!(e=>"get"!==e&&"post"!==e&&"put"!==e&&"delete"!==e&&"patch"!==e)(r)){const s=t.getAttribute(d);let c=t.getAttribute(i),h=(c||"all").toLowerCase();"one"!==h&&"all"!==h&&e(`${i} has only ONE or ALL values`);const p="all"===h;let f;p&&s&&(f={nodes:null,parentNode:null});const m=n?(e,t,o,n,s)=>u(void 0,void 0,r,l,e,t,o,n,s):()=>{u(t,f,r,l,!1,0)};let g=m;if(s){const t=(e,t,o,n,r,s,l)=>{const d=a().querySelectorAll(t),i=p?()=>{m(o,n,r,s,l)}:()=>{m(o,n,r,s,l);for(let t=0;t<d.length;t++){d[t].removeEventListener(e,i)}};for(let t=0;t<d.length;t++){d[t].addEventListener(e,i)}};if(s.indexOf(":")>0){const e=s.split(":"),o=e[0],n=e.slice(1).join(":");g=(e,r,s,l,d)=>{t(o,n,e,r,s,l,d)}}else e(`${d} attribute doesn't work without EventTargets`)}else c&&e(`${i} attribute doesn't work without ${d}`);return o(g)}e(`${s} has only GET, POST, PUT, PATCH or DELETE values`)}else e('The "source" attribute are not found or empty')},p={createTemplate:o=>{"string"!=typeof o&&e("template was not found or the type of the passed value is not string");const r=(o=>{const r=(new DOMParser).parseFromString(`<template>${o}</template>`,"text/html").childNodes[0].childNodes[0].firstChild;r.content.children.length>1&&e("Template include only one node with type 'Element'");const s=e=>{switch(e.nodeType){case Node.ELEMENT_NODE:if("pre"===e.tagName)return;break;case Node.TEXT_NODE:if(!/\S/.test(e.textContent))return void e.remove()}for(let t=0;t<e.childNodes.length;t++)s(e.childNodes.item(t))};s(r.content.childNodes[0]);const l=r.content.firstElementChild;return l?.nodeName===t&&null!==l.getAttribute(n)||e(`Other nodes, except those with the name "${t}" and attribute "${n}", are not yet supported`),l})(o);return h(r,(e=>({withCredentials:t=!1,timeout:o=0,headers:n,requestBody:r}={})=>{const s={element:void 0,status:0};return e(t,o,n,r,s),s}),!0)}},f=()=>{const o=a().querySelectorAll(`[${n}]`);for(let n=0;n<o.length;n++){const r=o[n];null===r.parentNode&&e('"parentNode" is null'),r.nodeName!==t&&e(`Other nodes, except those with the name "${t}", are not yet supported`);h(r,(e=>{e()}))}};return"loading"===a().readyState?a().addEventListener("DOMContentLoaded",f):f(),p}()}));
