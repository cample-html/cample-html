/*!
 * cample-html v0.0.4 (https://github.com/cample-html/cample-html)
 * Copyright (c) 2024 Anton Maklakov
 * Licensed under MIT (https://github.com/cample-html/blob/main/LICENSE)
 */
!function(e,t){"object"==typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.CampleHTML=e.CampleHTML||t()}("undefined"!=typeof self?self:this,(function(){return function(){"use strict";const e=e=>{throw new Error(e)},t="TEMPLATE",o="data-",n=`${o}cample`,r=`${o}src`,s=`${o}method`,l=`${o}status`,i=`${o}after`,d=`${o}mode`,a=()=>document,c=(t,o,n,r,s,i)=>{const{mode:d,cache:a,redirect:c,get:h,referrerPolicy:u,credentials:p,timeout:f,headers:m,requestBody:g}=s,v={method:n.toUpperCase()};if(void 0!==p&&(v.credentials=p),void 0!==g&&(v.body=g),void 0!==d&&(v.mode=d),void 0!==a&&(v.cache=a),void 0!==c&&(v.redirect=c),void 0!==u&&(v.referrerPolicy=u),m)if("object"!=typeof(y=m)||Array.isArray(y)||null===y)e('The "header" property does not have a value object');else{const t=new Headers;for(const o in m){const[n,r]=o;if("string"==typeof r)try{t.set(n,r)}catch(e){throw e}else e("Header has no string value")}v.headers=t}var y;f&&(v.signal=AbortSignal.timeout(f));const N=void 0!==i,E=e=>{i.status!==e&&(i.status=e,h?.("status",e))},T=e=>{e?t.setAttribute(l,e):t.removeAttribute(l)};N?E(0):T("loading"),fetch(r,v).then((t=>(N?E(t.status):T(),t.ok||e(`Request error with code ${t.status}`),t.text()))).then((n=>{const r=(t=>{"string"!=typeof t&&e("Bad response");const o=(new DOMParser).parseFromString(`<template>${t}</template>`,"text/html").childNodes[0].childNodes[0].firstChild,n=o.content,r=n.querySelectorAll("script");for(let e=0;e<r.length;e++){const t=r[e];n.removeChild(t)}return o})(n);if(N)i.element=r,h?.("element",r);else{const e=r.content.childNodes;if(o)if(o.nodes){const t=[],n=o.nodes.length;for(let r=0;r<n;r++){const s=o.nodes[r];if(r===n-1)for(let n=0;n<e.length;n++){const r=e[n],l=o.parentNode.insertBefore(r,s);t.push(l)}o.parentNode.removeChild(s)}o.nodes=t}else{const n=t.parentNode,r=[];for(let o=0;o<e.length;o++){const s=e[o],l=n.insertBefore(s,t);r.push(l)}n.removeChild(t),o.nodes=r,o.parentNode=n}else{const o=t.parentNode;for(let n=0;n<e.length;n++){const r=e[n];o.insertBefore(r,t)}o.removeChild(t)}}})).catch((e=>{throw e}))},h=(t,o,n)=>{const l=t.getAttribute(r);if(l){const r=(t.getAttribute(s)||"GET").toLowerCase();if(!(e=>"get"!==e&&"post"!==e&&"put"!==e&&"delete"!==e&&"patch"!==e)(r)){const s=t.getAttribute(i);let h=t.getAttribute(d),u=(h||"all").toLowerCase();"one"!==u&&"all"!==u&&e(`${d} has only ONE or ALL values`);const p="all"===u;let f;p&&s&&(f={nodes:null,parentNode:null});const m=n?(e,t)=>c(void 0,void 0,r,l,e,t):()=>{c(t,f,r,l,{})};let g=m;if(s){const t=(e,t,o,n)=>{const r=a().querySelectorAll(t),s=p?()=>{m(o,n)}:()=>{m(o,n);for(let t=0;t<r.length;t++){r[t].removeEventListener(e,s)}};for(let t=0;t<r.length;t++){r[t].addEventListener(e,s)}};if(s.indexOf(":")>0){const e=s.split(":"),o=e[0],n=e.slice(1).join(":");g=(e,r)=>{t(o,n,e,r)}}else e(`${i} attribute doesn't work without EventTargets`)}else h&&e(`${d} attribute doesn't work without ${i}`);return o(g)}e(`${s} has only GET, POST, PUT, PATCH or DELETE values`)}else e('The "source" attribute are not found or empty')},u={createTemplate:o=>{"string"!=typeof o&&e("template was not found or the type of the passed value is not string");const r=(o=>{const r=(new DOMParser).parseFromString(`<template>${o}</template>`,"text/html").childNodes[0].childNodes[0].firstChild;r.content.children.length>1&&e("Template include only one node with type 'Element'");const s=e=>{switch(e.nodeType){case Node.ELEMENT_NODE:if("pre"===e.tagName)return;break;case Node.TEXT_NODE:if(!/\S/.test(e.textContent))return void e.remove()}for(let t=0;t<e.childNodes.length;t++)s(e.childNodes.item(t))};s(r.content.childNodes[0]);const l=r.content.firstElementChild;return l?.nodeName===t&&null!==l.getAttribute(n)||e(`Other nodes, except those with the name "${t}" and attribute "${n}", are not yet supported`),l})(o);return h(r,(t=>(o={})=>{const n={element:void 0,status:0};var r;return o.get&&(r=o.get,"[object Function]"!==Object.prototype.toString.call(r)&&e("The get property has a function value")),t(o,n),n}),!0)}},p=()=>{const o=a().querySelectorAll(`[${n}]`);for(let n=0;n<o.length;n++){const r=o[n];null===r.parentNode&&e('"parentNode" is null'),r.nodeName!==t&&e(`Other nodes, except those with the name "${t}", are not yet supported`);h(r,(e=>{e()}))}};return"loading"===a().readyState?a().addEventListener("DOMContentLoaded",p):p(),u}()}));